using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace RedAceite_ING_SOFTWARE.Forms
{
    public partial class FrmPrincipal : Form
    {
        private Form activeForm = null;

        public FrmPrincipal()
        {
            InitializeComponent();
            
            // Make profile button rounded
            btnProfile.Region = System.Drawing.Region.FromHrgn(CreateRoundRectRgn(0, 0, btnProfile.Width, btnProfile.Height, 20, 20));
        }

        // Windows API for rounded button
        [System.Runtime.InteropServices.DllImport("Gdi32.dll", EntryPoint = "CreateRoundRectRgn")]
        private static extern IntPtr CreateRoundRectRgn(int nLeftRect, int nTopRect, int nRightRect, int nBottomRect, int nWidthEllipse, int nHeightEllipse);

        // Open child form in main panel
        private void OpenChildForm(Form childForm)
        {
            if (activeForm != null)
                activeForm.Close();
            
            activeForm = childForm;
            childForm.TopLevel = false;
            childForm.FormBorderStyle = FormBorderStyle.None;
            childForm.Dock = DockStyle.Fill;
            panelMain.Controls.Add(childForm);
            panelMain.Tag = childForm;
            childForm.BringToFront();
            childForm.Show();
        }

        // Sidebar button events
        private void btnClientes_Click(object sender, EventArgs e)
        {
            lblTitle.Text = "Clientes";
            // TODO: Open clients form
            MessageBox.Show("Funcionalidad de Clientes próximamente", "Clientes", MessageBoxButtons.OK, MessageBoxIcon.Information);
        }

        private void btnManifiestos_Click(object sender, EventArgs e)
        {
            lblTitle.Text = "Manifiestos";
            // TODO: Open manifiestos form
            MessageBox.Show("Funcionalidad de Manifiestos próximamente", "Manifiestos", MessageBoxButtons.OK, MessageBoxIcon.Information);
        }

        private void btnRemitos_Click(object sender, EventArgs e)
        {
            lblTitle.Text = "Remitos";
            // Open Generar Remito form
            try
            {
                OpenChildForm(new FrmGenerarRemito());
            }
            catch
            {
                MessageBox.Show("Funcionalidad de Remitos próximamente", "Remitos", MessageBoxButtons.OK, MessageBoxIcon.Information);
            }
        }

        private void btnEmpleados_Click(object sender, EventArgs e)
        {
            lblTitle.Text = "Empleados";
            // TODO: Open employees form
            MessageBox.Show("Funcionalidad de Empleados próximamente", "Empleados", MessageBoxButtons.OK, MessageBoxIcon.Information);
        }

        private void btnProveedores_Click(object sender, EventArgs e)
        {
            lblTitle.Text = "Proveedores";
            // Open Gestion Proveedores form
            OpenChildForm(new FrmGestionProveedores());
        }

        private void btnUsuarios_Click(object sender, EventArgs e)
        {
            // Toggle submenu
            panelUsuariosSubmenu.Visible = !panelUsuariosSubmenu.Visible;
        }

        private void btnUsuarios_MouseEnter(object sender, EventArgs e)
        {
            // Show submenu on hover
            panelUsuariosSubmenu.Visible = true;
        }

        private void btnCrearUsuario_Click(object sender, EventArgs e)
        {
            lblTitle.Text = "Crear Usuario";
            // Open Crear Usuario form
            OpenChildForm(new FrmCrearUsuario());
        }

        // Top bar events
        private void btnNotifications_Click(object sender, EventArgs e)
        {
            MessageBox.Show("No hay notificaciones nuevas", "Notificaciones", MessageBoxButtons.OK, MessageBoxIcon.Information);
        }

        private void btnProfile_Click(object sender, EventArgs e)
        {
            MessageBox.Show("Configuración de perfil próximamente", "Perfil", MessageBoxButtons.OK, MessageBoxIcon.Information);
        }

        // Dashboard panel events
        private void panelRemitos_Click(object sender, EventArgs e)
        {
            btnRemitos_Click(sender, e);
        }

        private void panelClientes_Click(object sender, EventArgs e)
        {
            btnClientes_Click(sender, e);
        }

        private void panelManifiestos_Click(object sender, EventArgs e)
        {
            btnManifiestos_Click(sender, e);
        }
    }
}
